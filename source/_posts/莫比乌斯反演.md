---
title: 莫比乌斯反演
date: 2022-03-25 16:28:55
mathjax: true
tags: 算法
---

### 莫比乌斯反演
对于一些函数$f(x)$,如果很难直接求出它的值，而容易求出**其倍数和或约数和**$g(x)$那么可以通过莫比乌斯反演简化运算，求得$f(x)$的值。

如果有 $f(n)=\sum_{d|n}g(d)$那么就有 $g(n)=\sum_{d|n}\mu(d)f(n/d)$

如果有 $f(n)=\sum_{n|d}g(d)$那么就有 $g(n)=\sum_{n|d}\mu(d/n)f(d)$

这两条式子非常清新脱俗。想必看一眼就能明白（bushi）。

首先解释一下$\sum_{d|n}g(d)$ 

和$\sum_{n|d}g(d)$这是什么意思。

$\sum_{d|n}g(d)$就是对所有$d$是$n$的约数的$g(d)$求和。

$\sum_{n|d}g(d)$就是对所有$n$是$d$的倍数的$g(n)$求和。

到这里应该都好理解。

接下来解释一下$\mu(n)$是做什么的


$$
\mu(x)=\left\{
\begin{aligned}
1 && n=1 \\
(-1)^k && n=\prod_{i=1}^k p_{i}\\
\end{aligned}
\right.
$$

解释一下，上面的 $p_{i}$ 是互不相等的质数。(下同)
也就是说当x是必须得是**互不相等奇数个质数的乘积**结果才为-1。
如果x是**互不相等**偶数个质数的乘积和x为1时，那么结果就是1。
其余结果为0。
这个式子看着很抽象，但是你只要先记着，他是来描述一个数他的自身与质数有关结构的就好了。
而且他有一个顶好的性质如下
$$
\sum_{d|n} \mu(d) = 1
$$
证明如下：
色(设)：$n=\prod_{i=1}^kp_{i}^{c_i}$$n^{'}=\prod_{i=1}^kp_{i}$
那么
其实也就是说$n^{'}$是$n$的倍数。


下面是一道例题的链接

https://www.acwing.com/problem/content/2704/

不清楚gcd过程的可以去补习一下欧几里得算法，以下不做详细证明。
