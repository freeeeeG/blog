---
title: FFT(法法塔)变化及其总结
date: 2021-10-28 18:01:44
mathjax: true
tags: 算法
---
# 简介
FFT，人称FA♂FA塔。别名，快速傅里花变化。
本文只探讨在算法中如何用FFT将多项式乘积优化到时间复杂度为o(nlogn)。
前置知识：复变函数。
## 前置知识
### 多项式处理

简单来说，形如 a0+a1X+a2X2+⋯+anXn 的代数表达式叫做多项式
多项式的处理一般有两种方式：
（敲重点！！！！）
#### 1.系数表示法

P(X)=a0+a1X+a2X^2+⋯+anX^n，a0,a1,⋯,an叫做多项式的系数，同时这些系数也可以看成是一个n+1维的向量写作n+1维向量 a = (a0,a1,⋯,an)。

#### 2.顶点表示法

如果选取n+1个不同的数 x0,x1,⋯,xn对多项式进行求值，得到A(x0),A(x1),⋯,A(xn)，那么就称(xi,A(xi)):0≤i≤n,i∈Z为多项式A(x) 的点值表示
这一步看着很抽象但是其实是这样的。
先从最简单的也是我们最熟悉的一阶 y = kx + b  开始考虑
我们只需要知道点A（x0，y0），B（x1，y1）就能晓得 y 的表达式。
那如果是y = a2x^2+a1x^1+a0 很显然需要三个点才能解出这个式子。
那么易得，P(X)需要n+1维的向量才能被求解出来

#### 3.多项式乘法

![](2.png)
![](3.png)

想必两张图解释的很清楚了。
这一步很关键。我们之后的分治就是依据这里的多项推导公式进行递归。
### 复数相关内容
#### 单位复根
单位根

n次单位根是指能够满足方程zn=1的复数，这些复数一共有n个它们都分布在复平面的单位圆上，并且构成一个正 n边形，它们把单位圆等分成n个部分

根据复数乘法相当于模长相乘，幅角相加就可以知道，n次单位根的模长一定是1，幅角的n倍是0
这样，n 次单位根也就是
e^(2πkin),k=0,1,2,⋯,n−1
再根据欧拉公式
e^(θi)=cosθ+isinθ
就可以知道 n 次单位根的算术表示
如果记ωn=e^(2πi/n)，那么n次单位根就是 ω0,ω1,⋯,ωn−1
![](1.png)
如上图
其实这个图上（也就是在复变函数里）写成幂次有个很好的性质，就是上图每一个点与其它点相乘，都是在原来的线段上旋转该点与原点链接的线段与x轴的角度。
如果你要知道为什么有这样一个性质，这边建议你去学习一下基础的群论和复变函数的知识。
不然你只需要知道和会验证如下的简单性质

(cos( n ) + i * sin ( n )) * (cos ( m ) + i * sin ( m )) = cos ( n + m ) + i * sin ( n + m )

所以上面的欧拉公式的左边的 e^(θi) 可以表示旋转。
那么这个弱智玩意干什么用的。看着真的特喵的囬气。
别急，一般人都是死在看不懂这个图上，但是我们只需要对他理解的一个性质就好了。
就是我们可以像切蛋糕一样，把它均分成2^n份（先别急着问为什么要切成2的幂次倍，晚点你就知道了）
那么e^(2pi/2^n)也就是我们说的单位根我们绕着它走一圈就能回到起点对吧（好好理解这里，后面要用的）；
![](4.png)
上图的性质只求会用，暂不深究，有兴趣者自行推导。
现在，我们带入到FFT中去理解

#### 大魔王的终极愤怒之屠龙勇士用火之高兴（FFT）奋力一击刚好斩杀并血冒三丈人头落地之马革裹尸（中二之力控制不住了）

计算多项式的乘法，或者计算两个大整数的乘法是在计算机中很常见的运算，如果用普通的方法进行，复杂度将会是O(n2)​的，还有一种分治乘法，可以做到 O(nlog23)​时间计算（可以看Karatsuba 乘法）。下面从计算多项式的乘法出发，介绍快速傅里叶变换（Fast Fourier Transform, FFT）如何在 O(nlogn)​的时间内计算出两个多项式的乘积。

这里读者先画3秒思考如何用普通方法来破此题。

1

2

3

很好，你会发现无论如何好像都要O(n2)才能解决这个问题。
那是因为你还在笛卡尔直角坐标系下考虑这个世界的一切和变化，
可惜的是，在宇宙的眼中，这个世界的奥妙可不是你们凡人能够随意感受和拿捏的
但是这时候，你拿出真理可视之眼—————FFT将我们平日里见到的笛卡尔坐标系的值转化到另一个域中去观察，
才会一睹那不可名状的真理的一丝容貌，它的值似乎于我们而言没有任何意义，但是却能精确的描述我们想要提出的问题。

首先！！！
##### 第一回合：
起手特殊召唤多项式的系数表示法，将题面中的大数看成 P(X) = a0+a1X+a2X^2+⋯+anX^n。
此时不难理解当X = 10 时即为我们题面的两个要相乘的大数。
然后发动魔法卡 等价转化 让P(X)转化成顶点表示法。
这时候我们需要去找n+1个不同的值带入进去，得到P(X)的点值表示。
然后回合结束。

此时对方发动场景卡，不可视之眼。让玩家陷入不知如何找n+1的困惑之中，从而活力降低2点，并进行一次san check；

##### 第二回合：
使用大数学家欧拉之力，召唤单位根。
并使用魔法卡融合。将P(X)的顶点表示法与单位根融合————召唤 复变顶点怪。
![](5.png)
因为单位根可以任意均分，所以先将其均分成n+1个，这样就满足解出P(X)的需求了；
此时埋伏两张陷阱卡。
然后回合结束。

对方埋伏一张魔法卡，回合结束。

###### 第三回合

复变顶点怪进行攻击，攻击有效，因为每一个


